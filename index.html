<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Spindle Enhancer Quick Estimator | Haas VF-4/5/6</title>
  <meta name="description" content="Lean load to kJ and battery runtime estimator for Haas VF-4, VF-5/40, VF-6/40 with 12k spindle option assumptions and macro logging workflow.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600;700&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #f4f5f7;
      --bg-card: #ffffff;
      --bg-card-alt: #f0f1f4;
      --bg-th: #e4e6ec;
      --bg-tr: #fafbfc;
      --bg-tr-alt: #f2f3f6;
      --bdr: #d0d3dc;
      --bdr-hi: #b5b9c6;
      --c1: #1a1d26;
      --c2: #4b5068;
      --c3: #6e7389;
      --amber: #2563eb;
      --amber-d: #1d4ed8;
      --amber-g: rgba(37, 99, 235, 0.06);
      --blue: #2563eb;
      --green: #15803d;
      --mono: "IBM Plex Mono", monospace;
      --sans: "DM Sans", system-ui, sans-serif;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: var(--bg);
      color: var(--c1);
      font-family: var(--sans);
      font-size: 15px;
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
    }

    .ctr {
      max-width: 1000px;
      margin: 0 auto;
      padding: 0 24px;
    }

    header {
      padding: 56px 0 40px;
      border-bottom: 1px solid var(--bdr);
      background: radial-gradient(circle at 85% -10%, var(--amber-g), transparent 35%);
    }

    .tag {
      display: inline-flex;
      font-family: var(--mono);
      font-size: 11px;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: var(--amber);
      background: var(--amber-g);
      border: 1px solid rgba(37, 99, 235, 0.18);
      padding: 6px 12px;
      border-radius: 3px;
      margin-bottom: 16px;
    }

    h1 {
      font-family: var(--mono);
      font-size: clamp(26px, 4vw, 40px);
      line-height: 1.15;
      margin-bottom: 12px;
    }

    .sub {
      color: var(--c2);
      max-width: 76ch;
    }

    nav {
      position: sticky;
      top: 0;
      z-index: 30;
      background: rgba(244, 245, 247, 0.92);
      border-bottom: 1px solid var(--bdr);
      backdrop-filter: blur(8px);
    }

    .nav-inner {
      display: flex;
      gap: 6px;
      overflow-x: auto;
      scrollbar-width: none;
      white-space: nowrap;
    }

    .nav-inner::-webkit-scrollbar {
      display: none;
    }

    .nav-inner a {
      text-decoration: none;
      color: var(--c3);
      font-family: var(--mono);
      font-size: 11px;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      padding: 13px 14px;
      border-bottom: 2px solid transparent;
    }

    .nav-inner a:hover {
      color: var(--c2);
      border-bottom-color: var(--bdr-hi);
    }

    section {
      padding: 44px 0;
      border-bottom: 1px solid var(--bdr);
    }

    .slabel {
      font-family: var(--mono);
      font-size: 10px;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: var(--amber-d);
      margin-bottom: 10px;
    }

    h2 {
      font-family: var(--mono);
      font-size: 22px;
      margin-bottom: 8px;
    }

    .sdesc {
      color: var(--c2);
      max-width: 80ch;
      margin-bottom: 18px;
    }

    .sg {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(210px, 1fr));
      gap: 14px;
      margin: 18px 0 20px;
    }

    .sc {
      background: var(--bg-card);
      border: 1px solid var(--bdr);
      border-radius: 4px;
      padding: 16px;
    }

    .sv {
      font-family: var(--mono);
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .sv small {
      font-size: 14px;
      color: var(--c3);
      font-weight: 500;
    }

    .sl {
      font-family: var(--mono);
      font-size: 11px;
      color: var(--c3);
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .ss {
      font-size: 12px;
      color: var(--c3);
      margin-top: 6px;
    }

    .tw {
      overflow-x: auto;
      border: 1px solid var(--bdr);
      border-radius: 4px;
      background: var(--bg-card);
      margin: 14px 0;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-family: var(--mono);
      font-size: 13px;
    }

    thead th {
      background: var(--bg-th);
      color: var(--c2);
      font-size: 10px;
      letter-spacing: 0.09em;
      text-transform: uppercase;
      text-align: left;
      padding: 11px 14px;
      border-bottom: 1px solid var(--bdr);
      white-space: nowrap;
    }

    tbody td {
      padding: 10px 14px;
      border-bottom: 1px solid var(--bdr);
      white-space: nowrap;
    }

    tbody tr:nth-child(even) {
      background: var(--bg-tr-alt);
    }

    tbody tr:last-child td {
      border-bottom: none;
    }

    .hi {
      color: var(--amber);
      font-weight: 600;
    }

    .dm {
      color: var(--c3);
    }

    .gd {
      color: var(--green);
      font-weight: 600;
    }

    .co {
      background: var(--bg-card);
      border: 1px solid var(--bdr);
      border-left: 3px solid var(--blue);
      border-radius: 3px;
      padding: 16px 18px;
      margin-top: 12px;
      color: var(--c2);
    }

    .co b {
      color: var(--c1);
    }

    .fm {
      background: var(--bg-card-alt);
      border: 1px solid var(--bdr);
      border-radius: 4px;
      padding: 14px 16px;
      margin-top: 14px;
      font-family: var(--mono);
      font-size: 13px;
      color: #0e7490;
      line-height: 1.9;
    }

    .calc-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(190px, 1fr));
      gap: 12px;
      margin-top: 8px;
    }

    label {
      display: flex;
      flex-direction: column;
      gap: 6px;
      font-family: var(--mono);
      font-size: 11px;
      color: var(--c3);
      text-transform: uppercase;
      letter-spacing: 0.06em;
    }

    select,
    input {
      font-family: var(--mono);
      font-size: 14px;
      color: var(--c1);
      background: var(--bg-card);
      border: 1px solid var(--bdr);
      border-radius: 3px;
      padding: 10px 11px;
      outline: none;
    }

    select:focus,
    input:focus {
      border-color: var(--bdr-hi);
    }

    .calc-results {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 12px;
      margin-top: 14px;
    }

    .calc-card {
      background: var(--bg-card);
      border: 1px solid var(--bdr);
      border-radius: 4px;
      padding: 14px 16px;
    }

    .calc-card h4 {
      font-family: var(--mono);
      font-size: 10px;
      color: var(--c3);
      text-transform: uppercase;
      letter-spacing: 0.09em;
      margin-bottom: 6px;
    }

    .cv {
      font-family: var(--mono);
      font-size: 23px;
      color: var(--amber);
      font-weight: 700;
    }

    .cu {
      font-family: var(--mono);
      font-size: 12px;
      color: var(--c3);
      margin-top: 4px;
    }

    ul {
      margin-left: 18px;
      color: var(--c2);
    }

    li {
      margin: 6px 0;
    }

    code {
      font-family: var(--mono);
      font-size: 12px;
      color: #0e7490;
      background: rgba(0, 0, 0, 0.05);
      padding: 2px 5px;
      border-radius: 3px;
    }

    .src-list {
      display: grid;
      gap: 9px;
    }

    .src-list a {
      color: var(--c1);
      text-decoration: none;
      border: 1px solid var(--bdr);
      background: var(--bg-card);
      border-radius: 4px;
      padding: 10px 12px;
      display: block;
    }

    .src-list a:hover {
      border-color: var(--bdr-hi);
      background: var(--bg-card-alt);
    }

    footer {
      padding: 28px 0 34px;
      color: var(--c3);
      font-family: var(--mono);
      font-size: 11px;
      text-align: center;
    }

    /* === Tooltip System === */
    [data-tip] {
      cursor: help;
    }

    #tip-box {
      position: fixed;
      top: 12px;
      right: 24px;
      width: 300px;
      background: var(--c1);
      color: #f4f5f7;
      font-family: var(--sans);
      font-size: 13px;
      font-weight: 400;
      line-height: 1.55;
      padding: 14px 16px;
      border-radius: 8px;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.18s ease;
      z-index: 200;
      box-shadow: 0 6px 24px rgba(0,0,0,0.18);
    }

    #tip-box.visible {
      opacity: 1;
    }

    /* === RPM Bar Chart === */
    .rpm-chart {
      margin: 20px 0 28px;
      padding: 20px;
      background: var(--bg-card);
      border: 1px solid var(--bdr);
      border-radius: 4px;
    }

    .rpm-row {
      margin-bottom: 22px;
    }

    .rpm-row:last-child {
      margin-bottom: 0;
    }

    .rpm-row-label {
      font-family: var(--mono);
      font-size: 14px;
      font-weight: 700;
      margin-bottom: 6px;
    }

    .rpm-bar-wrap {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 4px;
    }

    .rpm-bar {
      height: 28px;
      border-radius: 3px;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      padding: 0 10px;
      font-family: var(--mono);
      font-size: 11px;
      font-weight: 600;
      color: #fff;
      min-width: 60px;
    }

    .rpm-bar.ideal {
      background: var(--green);
    }

    .rpm-bar.actual {
      background: #dc2626;
    }

    .rpm-vc {
      font-family: var(--mono);
      font-size: 12px;
      font-weight: 600;
      color: #dc2626;
      white-space: nowrap;
    }

    #tip-box::before {
      content: 'INFO';
      display: block;
      font-family: var(--mono);
      font-size: 9px;
      letter-spacing: 0.12em;
      color: rgba(244,245,247,0.45);
      margin-bottom: 6px;
    }
  </style>
</head>
<body>
  <header>
    <div class="ctr">
      <h1 data-tip="Tool for estimating battery requirements for an external spindle enhancer on Haas vertical mills">Spindle Enhancer Quick Estimator</h1>
      <p class="sub" data-tip="These three machines share the same 30hp vector-drive spindle platform from Haas">
        Assumes VF-4 / VF-5/40 / VF-6/40 with the 12k spindle option. Load, energy, and runtime estimates for battery-powered spindle enhancer planning.
      </p>
    </div>
  </header>

  <nav>
    <div class="ctr">
      <div class="nav-inner">
        <a href="#specs" data-tip="Machine power specs and load meter reference table">Specs</a>
        <a href="#slotting" data-tip="Cutting power estimates for 1mm-2.5mm endmills in 6061-T6 aluminium">6061 Quick Table</a>
        <a href="#calculator" data-tip="Interactive calculator: enter load % and battery Wh to estimate runtime">Calculator</a>
        <a href="#macro" data-tip="How to capture live spindle data using Haas macro variables and DPRNT">Macro Logging</a>
        <a href="#sources" data-tip="Links to official Haas specs, macro docs, and DeWalt battery info">Sources</a>
      </div>
    </div>
  </nav>

  <section id="specs">
    <div class="ctr">
      <div class="slabel" data-tip="Section 1: baseline power numbers that all calculations are derived from">01 | Machine Baseline</div>
      <h2 data-tip="All three machines use the same 30hp spindle motor platform — same load math applies to all">Haas VF-4 / VF-5/40 / VF-6/40</h2>
      <p class="sdesc" data-tip="The 100% load mark on the Haas control corresponds to the continuous kW rating, not peak">Power baseline for load to energy conversion. Max RPM shown as your 12k installed spindle setup.</p>

      <div class="sg">
        <div class="sc" data-tip="Peak spindle motor rating. Only available for short bursts (3 min at 200% load). Equals 22.4 kW.">
          <div class="sv">30 <small>hp</small></div>
          <div class="sl">Max Rating</div>
          <div class="ss">22.4 kW peak</div>
        </div>
        <div class="sc" data-tip="Continuous (S1 duty) spindle rating. The load meter bar reads 100% at exactly this value. Can run indefinitely.">
          <div class="sv">11.2 <small>kW</small></div>
          <div class="sl">Continuous Power</div>
          <div class="ss">Used for 100% load math</div>
        </div>
        <div class="sc" data-tip="Maximum spindle speed with the optional 12,000 RPM spindle cartridge installed. Standard is 8,100 RPM.">
          <div class="sv">12,000 <small>rpm</small></div>
          <div class="sl">Max RPM in Your Setup</div>
          <div class="ss">12k spindle option installed</div>
        </div>
      </div>

      <div class="tw">
        <table>
          <thead>
            <tr>
              <th data-tip="Percentage shown on the Haas control's spindle load bar graph. Read via macro variable #1098.">Load Meter</th>
              <th data-tip="Electrical power draw at the spindle motor, calculated as Load% / 100 x 11.2 kW">Power</th>
              <th data-tip="How long the spindle can sustain this load level before thermal protection kicks in">Duty</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="hi" data-tip="Half of continuous rating — very light machining, typical for small tools at high RPM">50%</td>
              <td data-tip="5.6 kW = 7.5 hp — well within continuous capability">5.6 kW</td>
              <td data-tip="Can run at this load indefinitely without overheating">Continuous</td>
            </tr>
            <tr>
              <td class="hi" data-tip="Full continuous rating — the spindle can sustain this load indefinitely">100%</td>
              <td data-tip="11.2 kW = 15 hp — full continuous power">11.2 kW</td>
              <td data-tip="S1 duty rating: no time limit at this load">Continuous</td>
            </tr>
            <tr>
              <td class="hi" data-tip="50% above continuous — entering overload territory, motor generates excess heat">150%</td>
              <td data-tip="16.8 kW = 22.5 hp — overload region">16.8 kW</td>
              <td data-tip="Thermal limit: spindle will overheat if sustained beyond ~10 minutes">10 min max</td>
            </tr>
            <tr>
              <td class="hi" data-tip="Full peak power — absolute maximum, triggers alarm if sustained too long">200%</td>
              <td data-tip="22.4 kW = 30 hp — peak motor capability">22.4 kW</td>
              <td data-tip="Very short duty: alarm will trigger beyond ~3 minutes at full peak">3 min max</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="fm" data-tip="Core formulas used throughout this page. Power is proportional to load %. Energy = power x time. 1 Wh = 3.6 kJ for battery conversion.">
        Power (kW) = (Load% / 100) x 11.2<br>
        Energy (kJ) = Power (kW) x Time (s)<br>
        1 Wh = 3.6 kJ
      </div>
    </div>
  </section>

  <section id="slotting">
    <div class="ctr">
      <div class="slabel" data-tip="Section 2: theoretical cutting power for micro endmills in aluminium">02 | 6061 Quick Table</div>
      <h2 data-tip="Covers 1.0, 1.5, 2.0, and 2.5 mm diameter endmills running at maximum 12k RPM">1.0 to 2.5 mm Endmills at 12,000 RPM</h2>
      <p class="sdesc" data-tip="'Cutting power' is only the energy consumed by chip removal. Real spindle electrical draw is much higher because of bearing friction, drivetrain losses, and no-load motor power.">
        Cutting-only estimate for full-width slotting with 1mm–2.5mm end mills. Real spindle electrical draw is higher because no-load and drivetrain losses dominate.
      </p>

      <h3 style="font-family:var(--mono);font-size:16px;margin-top:24px;margin-bottom:6px" data-tip="Shows why a spindle enhancer is needed: even at 12,000 RPM these tools run far below their ideal surface speed">Recommended RPM vs Haas 12,000</h3>
      <p class="sdesc" data-tip="Ideal RPM calculated at Vc = 250 m/min (standard for carbide in 6061-T6). Formula: RPM = Vc × 1000 / (π × D). Even at 12k RPM the surface speed is too low for proper chip formation.">Micro endmills need 30,000–80,000 RPM for proper surface speed in aluminium. At 12,000 RPM these tools run at 15–38% of optimal — still rubbing, not cutting.</p>

      <div class="rpm-chart" data-tip="Bar chart comparing ideal RPM (green, at Vc = 250 m/min) vs the Haas 12,000 RPM option spindle (red). The red bar shows what % of ideal surface speed you actually achieve.">
        <div class="rpm-row">
          <div class="rpm-row-label">1.0 <small style="color:var(--c3);font-weight:500">mm</small></div>
          <div class="rpm-bar-wrap">
            <div class="rpm-bar ideal" style="width:100%" data-tip="Ideal RPM for 1.0mm at Vc=250 m/min. Formula: 250×1000/(π×1.0) = 79,577">79,577 ideal</div>
          </div>
          <div class="rpm-bar-wrap">
            <div class="rpm-bar actual" style="width:15.1%" data-tip="12,000 RPM is only 15.1% of ideal for a 1.0mm endmill. Surface speed = 37.7 m/min vs 250 m/min target.">12,000</div>
            <span class="rpm-vc" data-tip="Only 15% of the recommended cutting speed — severe rubbing, poor chip formation, rapid built-up edge">15% Vc</span>
          </div>
        </div>

        <div class="rpm-row">
          <div class="rpm-row-label">1.5 <small style="color:var(--c3);font-weight:500">mm</small></div>
          <div class="rpm-bar-wrap">
            <div class="rpm-bar ideal" style="width:66.7%" data-tip="Ideal RPM for 1.5mm at Vc=250 m/min = 53,052">53,052 ideal</div>
          </div>
          <div class="rpm-bar-wrap">
            <div class="rpm-bar actual" style="width:15.1%" data-tip="12,000 RPM is only 22.6% of ideal for 1.5mm. Surface speed = 56.5 m/min vs 250 m/min target.">12,000</div>
            <span class="rpm-vc" data-tip="23% of recommended surface speed — still heavily rubbing">23% Vc</span>
          </div>
        </div>

        <div class="rpm-row">
          <div class="rpm-row-label">2.0 <small style="color:var(--c3);font-weight:500">mm</small></div>
          <div class="rpm-bar-wrap">
            <div class="rpm-bar ideal" style="width:50%" data-tip="Ideal RPM for 2.0mm at Vc=250 m/min = 39,789">39,789 ideal</div>
          </div>
          <div class="rpm-bar-wrap">
            <div class="rpm-bar actual" style="width:15.1%" data-tip="12,000 RPM is only 30.2% of ideal for 2.0mm. Surface speed = 75.4 m/min vs 250 m/min target.">12,000</div>
            <span class="rpm-vc" data-tip="30% of recommended — poor chip evacuation and surface finish">30% Vc</span>
          </div>
        </div>

        <div class="rpm-row">
          <div class="rpm-row-label">2.5 <small style="color:var(--c3);font-weight:500">mm</small></div>
          <div class="rpm-bar-wrap">
            <div class="rpm-bar ideal" style="width:40%" data-tip="Ideal RPM for 2.5mm at Vc=250 m/min = 31,831">31,831 ideal</div>
          </div>
          <div class="rpm-bar-wrap">
            <div class="rpm-bar actual" style="width:15.1%" data-tip="12,000 RPM is 37.7% of ideal for 2.5mm — closest to acceptable but still too slow for clean cutting">12,000</div>
            <span class="rpm-vc" data-tip="38% of recommended — best of the group but still well below minimum effective cutting speed">38% Vc</span>
          </div>
        </div>
      </div>

      <div class="tw">
        <table>
          <thead>
            <tr>
              <th data-tip="Diameter of the end mill being used">Tool Dia</th>
              <th data-tip="Estimated power consumed by the actual metal cutting process only — not total spindle draw">Cutting Power</th>
              <th data-tip="Kilojoules of energy consumed per minute of cutting at this power level">Energy Rate</th>
              <th data-tip="What this tiny cutting power represents as a % of the 11.2 kW continuous rating — essentially negligible">Load Equiv on 11.2 kW</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="hi" data-tip="1.0 mm diameter — smallest tool in the range. Very low material removal rate.">1.0 mm</td>
              <td data-tip="Less than 2 watts — the cutting itself uses almost no power">0.6 to 1.9 W</td>
              <td data-tip="At most 0.12 kJ/min — trivial energy consumption">0.03 to 0.12 kJ/min</td>
              <td class="dm" data-tip="Effectively 0% on the Haas load meter — you won't see the bar move">0.004 to 0.018%</td>
            </tr>
            <tr>
              <td class="hi" data-tip="1.5 mm diameter — slightly more aggressive but still very light cutting">1.5 mm</td>
              <td data-tip="Under 7 watts — still negligible vs. spindle no-load draw">1.9 to 6.4 W</td>
              <td data-tip="Under 0.4 kJ/min of cutting energy">0.12 to 0.39 kJ/min</td>
              <td class="dm" data-tip="Well under 0.1% — invisible on the load meter">0.016 to 0.056%</td>
            </tr>
            <tr>
              <td class="hi" data-tip="2.0 mm diameter — moderate micro endmill, common for fine detail work">2.0 mm</td>
              <td data-tip="Up to ~16 watts of cutting power">4.4 to 15.7 W</td>
              <td data-tip="Under 1 kJ/min — still very low energy consumption">0.27 to 0.95 kJ/min</td>
              <td class="dm" data-tip="About 0.1% load — the Haas meter won't register this">0.040 to 0.141%</td>
            </tr>
            <tr>
              <td class="hi" data-tip="2.5 mm diameter — largest tool in this micro range. Highest power of the group.">2.5 mm</td>
              <td data-tip="Up to ~32 watts — still small compared to spindle motor capacity">8.7 to 31.6 W</td>
              <td data-tip="Up to ~2 kJ/min — the most energy-intensive option in this table">0.52 to 1.90 kJ/min</td>
              <td class="dm" data-tip="Under 0.3% — still far too small to appear on the load meter">0.079 to 0.282%</td>
            </tr>
          </tbody>
        </table>
      </div>

      <h3 style="font-family:var(--mono);font-size:16px;margin-top:28px;margin-bottom:6px" data-tip="Estimated cutting power at 30,000 RPM — typical speed for a compact spindle enhancer. Power scales linearly from 12k baseline (×2.5).">At 30,000 RPM (Spindle Enhancer)</h3>
      <p class="sdesc" data-tip="30k RPM is a common speed for small external high-speed spindles. Cutting power is 2.5× the 12k values because you're removing material 2.5× faster at the same chipload.">Projected cutting power at 30k RPM with typical chiploads — 2.5× the 12k baseline. This is the power the enhancer motor must supply.</p>

      <div class="tw">
        <table>
          <thead>
            <tr>
              <th data-tip="Diameter of the end mill">Tool Dia</th>
              <th data-tip="Cutting power at 30k RPM — 2.5× the 12k value">Cutting Power</th>
              <th data-tip="Energy consumption rate at 30k RPM">Energy Rate</th>
              <th data-tip="Equivalent load on the enhancer motor (if rated at 11.2 kW — actual enhancer will be much smaller)">Load Equiv on 11.2 kW</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="hi" data-tip="1.0 mm at 30k RPM">1.0 mm</td>
              <td data-tip="1.5–4.8 watts — still very low power">1.5 – 4.8 W</td>
              <td data-tip="Under 0.3 kJ/min">0.09 – 0.29 kJ/min</td>
              <td class="dm" data-tip="Still negligible on an 11.2 kW scale">0.013 – 0.043%</td>
            </tr>
            <tr>
              <td class="hi" data-tip="1.5 mm at 30k RPM">1.5 mm</td>
              <td data-tip="Up to 16 watts">4.8 – 16.0 W</td>
              <td data-tip="Under 1 kJ/min">0.29 – 0.96 kJ/min</td>
              <td class="dm" data-tip="Under 0.15%">0.043 – 0.143%</td>
            </tr>
            <tr>
              <td class="hi" data-tip="2.0 mm at 30k RPM">2.0 mm</td>
              <td data-tip="Up to ~39 watts — starting to be noticeable on a small enhancer motor">11.0 – 39.3 W</td>
              <td data-tip="Up to ~2.4 kJ/min">0.66 – 2.36 kJ/min</td>
              <td class="dm" data-tip="About 0.35% of 11.2 kW">0.098 – 0.351%</td>
            </tr>
            <tr>
              <td class="hi" data-tip="2.5 mm at 30k RPM — highest power in this table">2.5 mm</td>
              <td data-tip="Up to ~79 watts — significant for a battery-powered enhancer">21.8 – 79.0 W</td>
              <td data-tip="Up to ~4.7 kJ/min">1.31 – 4.74 kJ/min</td>
              <td class="dm" data-tip="Under 0.7%">0.194 – 0.705%</td>
            </tr>
          </tbody>
        </table>
      </div>

      <h3 style="font-family:var(--mono);font-size:16px;margin-top:28px;margin-bottom:6px" data-tip="Estimated cutting power at 60,000 RPM — high-speed micro machining territory. Power scales linearly from 12k baseline (×5.0).">At 60,000 RPM (High-Speed Enhancer)</h3>
      <p class="sdesc" data-tip="60k RPM is typical for precision micro machining spindles. Cutting power is 5× the 12k values. At this speed, battery drain and tool breakage become real concerns.">Projected cutting power at 60k RPM — 5× the 12k baseline. Higher speeds enable aggressive micro-machining but drain battery faster.</p>

      <div class="tw">
        <table>
          <thead>
            <tr>
              <th data-tip="Diameter of the end mill">Tool Dia</th>
              <th data-tip="Cutting power at 60k RPM — 5× the 12k value">Cutting Power</th>
              <th data-tip="Energy consumption rate at 60k RPM">Energy Rate</th>
              <th data-tip="Equivalent load on 11.2 kW scale">Load Equiv on 11.2 kW</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="hi" data-tip="1.0 mm at 60k RPM">1.0 mm</td>
              <td data-tip="3–9.5 watts — still modest despite extreme RPM">3.0 – 9.5 W</td>
              <td data-tip="Under 0.6 kJ/min">0.18 – 0.57 kJ/min</td>
              <td class="dm" data-tip="Under 0.1%">0.027 – 0.085%</td>
            </tr>
            <tr>
              <td class="hi" data-tip="1.5 mm at 60k RPM">1.5 mm</td>
              <td data-tip="Up to 32 watts">9.5 – 32.0 W</td>
              <td data-tip="Up to ~1.9 kJ/min">0.57 – 1.92 kJ/min</td>
              <td class="dm" data-tip="Under 0.3%">0.085 – 0.286%</td>
            </tr>
            <tr>
              <td class="hi" data-tip="2.0 mm at 60k RPM — significant power for a small motor">2.0 mm</td>
              <td data-tip="Up to ~79 watts — this is where small enhancer motors start working hard">22.0 – 78.5 W</td>
              <td data-tip="Up to ~4.7 kJ/min">1.32 – 4.71 kJ/min</td>
              <td class="dm" data-tip="About 0.7% of 11.2 kW">0.196 – 0.701%</td>
            </tr>
            <tr>
              <td class="hi" data-tip="2.5 mm at 60k RPM — highest power in any table. Battery drain is real at this level.">2.5 mm</td>
              <td data-tip="Up to 158 watts — a small battery-powered motor will feel this">43.5 – 158.0 W</td>
              <td data-tip="Up to ~9.5 kJ/min — significant energy consumption">2.61 – 9.48 kJ/min</td>
              <td class="dm" data-tip="About 1.4% — still small on the 11.2 kW scale, but large for a 200-500W enhancer motor">0.388 – 1.411%</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="co" data-tip="Key insight: if using an external spindle enhancer motor, the Haas load meter only shows the Haas spindle load — not the enhancer's motor load. You need separate current monitoring on the enhancer.">
        <b>Interpretation:</b> if you drive the cutter with an external spindle enhancer, Haas spindle load will not represent enhancer motor load. Log enhancer electrical current separately.
      </div>
    </div>
  </section>

  <section id="calculator">
    <div class="ctr">
      <div class="slabel" data-tip="Section 3: interactive calculator — change any input and results update instantly">03 | Calculator</div>
      <h2 data-tip="Enter your observed spindle load and battery specs to estimate how long the battery will last">Load to kJ to Runtime</h2>
      <p class="sdesc" data-tip="Read the load % from the Haas control bar graph or capture it with macro #1098">Use observed load from the machine and your battery capacity to estimate runtime.</p>

      <div class="calc-grid">
        <label data-tip="Select your machine model to set the continuous power baseline (11.2 kW for 30hp, 7.5 kW for 20hp)">Machine
          <select id="c-machine">
            <option value="11.2">VF-4 / VF-5 / VF-6 (30 hp, 11.2 kW continuous)</option>
            <option value="7.5">VF-4 legacy (20 hp, 7.5 kW continuous)</option>
          </select>
        </label>
        <label data-tip="The load % shown on the Haas control's spindle bar graph, or read from macro variable #1098. Range: 0-200%.">Spindle Load (%)
          <input id="c-load" type="number" min="0" max="200" step="0.1" value="60">
        </label>
        <label data-tip="Total time the spindle is under load during your cutting operation, in minutes">Cut Duration (min)
          <input id="c-dur" type="number" min="0" step="0.1" value="10">
        </label>
        <label data-tip="Rated capacity of your battery pack in watt-hours. Example: DeWalt FLEXVOLT 6Ah 60V = 360 Wh nominal, ~240 Wh usable.">Battery Capacity (Wh)
          <input id="c-batt" type="number" min="0" step="1" value="240">
        </label>
        <label data-tip="Real-world efficiency factor (typically 75-85%). Accounts for heat loss, inverter inefficiency, and drivetrain friction.">Efficiency (%)
          <input id="c-eff" type="number" min="1" max="100" step="1" value="80">
        </label>
      </div>

      <div class="calc-results">
        <div class="calc-card" data-tip="Spindle power draw = Load% / 100 x continuous kW rating. This is the electrical power the spindle motor consumes.">
          <h4>Power Draw</h4><div class="cv" id="r-power">-</div><div class="cu" id="r-power-hp">-</div>
        </div>
        <div class="calc-card" data-tip="How fast energy is consumed: Power (kW) x 60 = kJ per minute. Higher load = faster energy drain.">
          <h4>Energy Rate</h4><div class="cv" id="r-rate">-</div><div class="cu">per minute</div>
        </div>
        <div class="calc-card" data-tip="Total energy consumed over the full cut duration: Power x Time. Shown in kJ and converted to Wh for battery comparison.">
          <h4>Total Energy</h4><div class="cv" id="r-total">-</div><div class="cu" id="r-total-wh">-</div>
        </div>
        <div class="calc-card" data-tip="How long the battery can power the spindle at this load level. Calculated as: (Battery Wh x 3.6 x Efficiency) / Power kW / 60.">
          <h4>Battery Runtime</h4><div class="cv" id="r-runtime">-</div><div class="cu">at this load</div>
        </div>
      </div>
    </div>
  </section>

  <section id="macro">
    <div class="ctr">
      <div class="slabel" data-tip="Section 4: workflow for capturing real spindle load data from the Haas control">04 | Macro Logging</div>
      <h2 data-tip="Use the included macro and script to log spindle load over time and export to CSV">Haas Data Capture Workflow</h2>
      <p class="sdesc" data-tip="All files are included in this GitHub repo — just load the macro and run it">Use the logger files in this repo. Keep this step simple and repeatable.</p>

      <ul>
        <li data-tip="#1098 is a read-only macro variable that returns the spindle load percentage from the vector drive. #3027 returns the actual spindle RPM. Both update in real-time.">Use <code data-tip="Haas system macro variable: spindle load % (0-200). Read-only. Updated by the vector drive in real-time.">#1098</code> for spindle load percent and <code data-tip="Haas system macro variable: actual spindle RPM. Read-only. Shows real RPM, not commanded RPM.">#3027</code> for actual spindle RPM.</li>
        <li data-tip="O9010 is a G-code subprogram that reads #1098 and #3027 in a loop, calculates power and cumulative energy, and outputs CSV lines via DPRNT.">Run <code data-tip="G-code macro: samples spindle load every 1s (configurable), outputs CSV via DPRNT. Edit #500/#501/#502 to configure.">macros/O9010.NC</code> on the control.</li>
        <li data-tip="DPRNT (Debug Print) writes text lines to an external file or TCP port. Configure the destination with Setting 261 (output mode) and Setting 262 (file path or IP).">Export <code data-tip="Raw text file generated by DPRNT statements. Contains comma-separated data lines — not a true CSV until cleaned.">DPRNT.OUT</code> from <code data-tip="Setting 261 = output mode (FILE or TCP). Setting 262 = destination path (USB, network share, or IP:port).">Setting 261/262</code> destination.</li>
        <li data-tip="PowerShell script that strips DPRNT formatting, trims whitespace from fields, removes LOG_COMPLETE marker, and writes a clean CSV file.">Convert to CSV with <code data-tip="PowerShell script included in this repo. Usage: -InputPath 'DPRNT.OUT' -OutputPath 'log.csv'. Requires -ExecutionPolicy Bypass.">scripts/convert_dprnt_to_csv.ps1</code>.</li>
      </ul>

      <div class="fm" data-tip="Copy-paste this command into PowerShell to convert your DPRNT output to a clean CSV file. The -ExecutionPolicy Bypass flag is needed because Windows blocks unsigned scripts by default.">
        powershell -ExecutionPolicy Bypass -File .\scripts\convert_dprnt_to_csv.ps1 -InputPath "DPRNT.OUT" -OutputPath "slotting_load_log.csv"
      </div>
    </div>
  </section>

  <section id="sources">
    <div class="ctr">
      <div class="slabel" data-tip="Section 5: external reference links used to build this page">05 | Sources</div>
      <h2 data-tip="Official manufacturer documentation and spec sheets">Reference Links</h2>
      <div class="src-list">
        <a href="https://www.haascnc.com/machines/vertical-mills/vf-series/models/medium/vf-4.html" target="_blank" rel="noopener" data-tip="Official Haas VF-4 spec sheet — 30hp spindle, 40-taper, 50x20x25 travels">Haas VF-4 Specs</a>
        <a href="https://www.haascnc.com/machines/vertical-mills/vf-series/models/medium/vf-5-40.html" target="_blank" rel="noopener" data-tip="Official Haas VF-5/40 spec sheet — same 30hp spindle platform, 50x26x25 travels">Haas VF-5/40 Specs</a>
        <a href="https://www.haascnc.com/machines/vertical-mills/vf-series/models/large/vf-6-40.html" target="_blank" rel="noopener" data-tip="Official Haas VF-6/40 spec sheet — same 30hp spindle, largest table in the group: 64x32x30 travels">Haas VF-6/40 Specs</a>
        <a href="https://www.haascnc.com/productivity/spindles/12k-40t-in.html" target="_blank" rel="noopener" data-tip="Haas 12,000 RPM 40-taper spindle option — replaces the standard 8,100 RPM cartridge">Haas 12k 40T Spindle Option</a>
        <a href="https://www.haascnc.com/reference-container/torque-chart-note.html" target="_blank" rel="noopener" data-tip="Haas torque curve documentation — explains how torque, power, and RPM relate across the spindle speed range">Haas Torque Chart Note</a>
        <a href="https://www.haascnc.com/service/online-operator-s-manuals/mill-operator-s-manual/mill---macros.html" target="_blank" rel="noopener" data-tip="Full Haas macro variable reference — includes #1098 (spindle load), #3027 (RPM), #3026 (tool number), and hundreds more">Haas Mill Macro Variables</a>
        <a href="https://www.haascnc.com/service/troubleshooting-and-how-to/how-to/communication-with-external-devices---dprnt.html" target="_blank" rel="noopener" data-tip="Haas DPRNT setup guide — how to configure Settings 261/262 and format DPRNT output statements in G-code">Haas DPRNT Guide</a>
        <a href="https://www.dewalt.com/systems/cordless-platforms/60v/flexvolt-battery-system" target="_blank" rel="noopener" data-tip="DeWalt FLEXVOLT 60V battery system — 6Ah pack = 360 Wh nominal. Common candidate for portable spindle enhancer power.">DEWALT FLEXVOLT Battery System</a>
      </div>
    </div>
  </section>

  <footer>
    <div class="ctr">
    </div>
  </footer>

  <script>
    (function () {
      const $ = (id) => document.getElementById(id);

      function calc() {
        const contKW = parseFloat($("c-machine").value);
        const load = parseFloat($("c-load").value) || 0;
        const dur = parseFloat($("c-dur").value) || 0;
        const battWh = parseFloat($("c-batt").value) || 0;
        const eff = (parseFloat($("c-eff").value) || 80) / 100;

        const powerKW = (load / 100) * contKW;
        const powerHP = powerKW / 0.7457;
        const rateKJ = powerKW * 60;
        const totalKJ = powerKW * dur * 60;
        const totalWh = totalKJ / 3.6;

        const usableKJ = battWh * 3.6 * eff;
        const runtimeS = powerKW > 0 ? usableKJ / powerKW : 0;
        const runtimeM = runtimeS / 60;

        $("r-power").textContent = powerKW.toFixed(2) + " kW";
        $("r-power-hp").textContent = powerHP.toFixed(1) + " hp";
        $("r-rate").textContent = rateKJ.toFixed(1) + " kJ/min";
        $("r-total").textContent = totalKJ.toFixed(0) + " kJ";
        $("r-total-wh").textContent = totalWh.toFixed(0) + " Wh";
        $("r-runtime").textContent = runtimeM.toFixed(1) + " min";
      }

      ["c-machine", "c-load", "c-dur", "c-batt", "c-eff"].forEach((id) => {
        $(id).addEventListener("input", calc);
      });

      calc();
    })();
  </script>

  <div id="tip-box"></div>
  <script>
    (function () {
      var box = document.getElementById('tip-box');
      document.addEventListener('mouseover', function (e) {
        var el = e.target.closest('[data-tip]');
        if (el) {
          box.textContent = el.getAttribute('data-tip');
          box.classList.add('visible');
        }
      });
      document.addEventListener('mouseout', function (e) {
        var el = e.target.closest('[data-tip]');
        if (el) {
          box.classList.remove('visible');
        }
      });
    })();
  </script>
</body>
</html>
